% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt

\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
% \geometry{margin=2in} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options

% \usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
\usepackage{setspace}
\usepackage{alltt}
\usepackage{amsmath}
% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}
\addtolength{\textheight}{1.6cm}
\addtolength{\textwidth}{0.6cm}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

%%% END Article customizations

%%% The "real" document content comes below...

\title{Assignment 4 $\ \ \ \ $ COMPSCI 720 - (2017)}
\author{Zhi Zhang $\ \ \ \ $ zzha822 $\ \ \ \ $ 708439475639}
\date{} % Activate to display a given date or no date (if empty),
         % otherwise the current date is printed

\begin{document}
\maketitle

\begin{enumerate}
	\item For the Johnson-Trotter algorithm for enumeration permutations:
	\begin{enumerate}
		\item Find the rank of 3142, 5137264, and 234561.
		\item[A:] \nobreak
				$Rank(1,2) = 2\cdot Rank(1) + (2-2) = 0 \\
				Rank(3,1,2) = 3\cdot Rank(1,2) + (3-1) = 2 \\
				Rank(3,1,4,2) = 4\cdot Rank(3,1,2) + (4-3) = 9 \\
				\\
				Rank(1,2) = 0, Rank(1,3,2) = 3\cdot Rank(1,2) + (3-2) = 1 \\
				Rank(1,3,2,4) = 4\cdot Rank(1,3,2) + (4-1) = 7 \\
				Rank(5,1,3,2,4) = 5\cdot Rank(1,3,2,4) + (1-1) = 35 \\
				Rank(5,1,3,2,6,4) = 6\cdot Rank(5,1,3,2,4) + (5-1) = 214 \\
				Rank(5,1,3,7,2,6,4) = 7\cdot Rank(5,1,3,2,6,4) + (7-4) = 1501 \\
				\\
				Rank(1) = 0, Rank(2,1) = 2\cdot Rank(1) + (2-1) = 1 \\
				Rank(2,3,1) = 3\cdot Rank(2,1) + (2-1) = 4 \\
				Rank(2,3,4,1) = 4\cdot Rank(2,3,1) + (4-3) = 17 \\
				Rank(2,3,4,5,1) = 5\cdot Rank(2,3,4,1) + (4-1) = 88 \\
				Rank(2,3,4,5,6,1) = 6\cdot Rank(2,3,4,5,1) + (6-5) = 529$ \\
		\item[(b)] Unrank the following integers for [14]: 6002 and 4442244.
		\item[A:] \nobreak
				$Unrank(6002)\ for\ [14], \\
				6002\ mod\ 14 = 10,\ 6002 / 14 = 428,\ \pi[4] = 14,\\
				428\ mod\ 13 = 12,\ 428 / 13 = 32,\ \pi[1] = 13,\\
				32\ mod\ 12 = 8,\ 32 / 12 = 2,\ \pi[6] = 12,\\
				2\ mod\ 11 = 2,\ 2 / 11 = 0,\ \pi[12] = 11,\\
				0\ mod\ 10 = 0,\ 0 / 10 = 0,\ \pi[14] = 10,\\
				0\ mod\ 9 = 0,\ 0 / 9 = 0,\ \pi[13] = 9,\\
				0\ mod\ 8 = 0,\ 0 / 8 = 0,\ \pi[11] = 8,\\
				0\ mod\ 7 = 0,\ 0 / 7 = 0,\ \pi[10] = 7,\\
				0\ mod\ 6 = 0,\ 0 / 6 = 0,\ \pi[9] = 6,\\
				0\ mod\ 5 = 0,\ 0 / 5 = 0,\ \pi[8] = 5,\\
				0\ mod\ 4 = 0,\ 0 / 4 = 0,\ \pi[7] = 4,\\
				0\ mod\ 3 = 0,\ 0 / 2 = 0,\ \pi[5] = 3,\\
				0\ mod\ 2 = 0,\ 0 / 2 = 0,\ \pi[3] = 2,\\
				0\ mod\ 1 = 0,\ 0 / 1 = 0,\ \pi[2] = 1,\\
				So,\ \pi : 6002 = (13,1,2,14,3,12,4,5,7,6,7,8,11,9,10)\\
				\\
                Unrank(4442244)\ for\ [14], \\
				4442244\ mod\ 14 = 2,\ 4442244 / 13 = 371303,\ \pi[3] = 14,\\
				371303\ mod\ 13 = 10,\ 371303 / 13 = 28561,\ \pi[12] = 13,\\
				28561\ mod\ 12 = 1,\ 28561 / 12 = 2380,\ \pi[13] = 12,\\
				2380\ mod\ 11 = 4,\ 2380 / 11 = 216,\ \pi[9] = 11,\\
				216\ mod\ 10 = 6,\ 216 / 10 = 21,\ \pi[8] = 10,\\
				21\ mod\ 9 = 3,\ 21 / 9 = 2,\ \pi[7] = 9,\\
				2\ mod\ 9 = 2,\ 2 / 9 = 0,\ \pi[10] = 8,\\
				0\ mod\ 9 = 0,\ 0 / 9 = 0,\ \pi[14] = 7,\\
				...,\ ...,\ \pi[11] = 6,\\
				...,\ ...,\ \pi[6] = 5,\\
				...,\ ...,\ \pi[5] = 4,\\
				...,\ ...,\ \pi[4] = 3,\\
				...,\ ...,\ \pi[2] = 2,\\
				...,\ ...,\ \pi[1] = 1,\\
				So,\ \pi : 4442244 = (1,2,14,3,4,5,9,10,11,8,6,13,12,7)$\\
	\end{enumerate}
	\item For the colex order of subsets:
	\begin{enumerate}
		\item Compute the rank of (2,5,9) and (2,5,6,8) of [9].
		\item[A:] \nobreak
				$Rank(2,5,9) = \binom{8}{3} + Rank(2,5)\\
				= \frac{8\times7\times6}{3\times2} + \binom{4}{2} + Rank(2)\\
				= 56 + 6 + 1 \\
				= 63$\\
                \\
				$Rank(2,5,6,8) = \binom{7}{4} + Rank(2,5,6)\\
				= \frac{7\times6\times5\times4}{3\times2} + \binom{5}{3} + Rank(2,5)\\
				= 140 + 10 + \binom{4}{2} + Rank(2)\\
				= 150 + 6 + 1 \\
				= 157$\\
        \item[(b)] Calculate Unrank(99) for the 4-subsets of [9].
        \item[A:] \nobreak
                $set\ k=4,\ m=99,\ then\ find\\
                \binom{9}{4}=\frac{9\times8\times7\times6}{4\times3\times2}>99>\binom{8}{4}\\
                So,\ v_{4}=9.\\
                Next\ k=3,\ m=99-\binom{8}{4}=29,\ then\ find\\
                \binom{7}{3}=\frac{7\times6\times5}{3\times2}>29>\binom{6}{3}\\
                So,\ v_{3}=7.\\
                Next\ k=2,\ m=29-\binom{6}{3}=9,\ then\ find\\
                \binom{5}{2}=10>9>\binom{4}{2}\\
                So,\ v_{2}=5.\\
                Final\ k=1,\ m=9-\binom{4}{2}=3,\ then\ find\\
                \binom{4}{1}=4>3>=\binom{3}{1}\\
                So,\ v_{1}=4.
                The\ subset\ of\ rank(99)\ is\ \{4,5,7,9\}$\\
    \end{enumerate}
    \item In the reverse lex order for integer partitions:
    \begin{enumerate}
        \item Find rank of $5\ 2^{3}\ 1^{2}$, $5\ 3\ 2$ and $2\ 1^{10}$.
        \item[A:] \nobreak
                $partition\ 5\ 2^{3}\ 1^{2}={5,2,2,2,1,1},\ so\ n=13.\\
                13\\
                12\ 1\\
                11\ 2\\
                11\ 1^{2}\\
                10\ 3\\
                10\ 2\ 1\\
                10\ 1^{3}\\
                9\ 4\\
                9\ 3\ 1\\
                9\ 2^{2}\\
                9\ 2\ 1^{2}\\
                9\ 1^{4}\\
                8\ 5\\
                8\ 4\ 1\\
                8\ 3\ 2\\
                8\ 3\ 1^{2}\\
                8\ 2\ 2\ 1\\
                8\ 2\ 1^{3}\\
                8\ 1^{5}\\
                7\ 6\\
                7\ 5\ 1\\
                7\ 4\ 2\\
                7\ 4\ 1^{2}\\
                7\ 3^{2}\\
                7\ 3\ 2\ 1\\
                7\ 3\ 1^{3}\\
                7\ 2^{3}\\
                7\ 2^{2}\ 1^{2}\\
			7\ 2\ 1^{4}\\
			7\ 1^{6}\\
			6^{2}\ 1\\
			6\ 5\ 2\\
			6\ 5\ 1^{2}\\
			6\ 4\ 3\\
			6\ 4\ 2\ 1\\
			6\ 4\ 1^{3}\\
			6\ 3^{2}\ 1\\
			6\ 3\ 2^{2}\\
			6\ 3\ 2\ 1^{2}\\
			6\ 3\ 1^{4}\\
			6\ 2\ 1^{5}\\
			6\ 1^{7}\\
			5^{2}\ 3\\
			5^{2}\ 2\ 1\\
			5^{2}\ 1^{3}\\
			5\ 4^{2}\\
			5\ 4\ 3\ 1\\
			5\ 4\ 2^{2}\\
			5\ 4\ 2\ 1^{2}\\
			5\ 4\ 1^{4}\\
			5\ 3^{2}\ 2\\
			5\ 3^{2}\ 1^{2}\\
			5\ 3\ 2^{2}\ 1\\
			5\ 3\ 2\ 1^{3}\\
			5\ 3\ 1^{5}\\
			5\ 2^{4}\\
			5\ 2^{3}\ 1^{2},\\
			So,\ Rank(5\ 2^{3}\ 1^{2}) = 56,\ if\ Rank(13) = 0\\
			\\
			Rank(5\ 3\ 2)\\
			= P(10) - S(5\ 3\ 2) - 1\\
			= P(10,10) - P(10,5) - S(3\ 2)\\
			= P(10,10) - P(10,5) - P(5,3) - S(2)\\
			= P(5,6) + P(4,7) + P(3,8) + P(2,9) + P(1,10) - P(5,3) - 1\\
			= P(5,3) + P(2,4) + P(1,5) + P(4,7) + P(3,8) + P(2,9) + P(1,10) - P(5,3)\\
			= P(2,4) + 1 + P(4,4) + 1 + P(3,3) + 1 + P(2,2) + 1 + 1\\
			= 1 + 1 + 1 + 4 + 1 + 2 + 1 + 1 + 1 + 1\\
			= 14\\
			\\
			Rank(2\ 1^{10})\\
			= P(12) - S(2\ 1^{10}) - 1\\
			= P(12,12) - P(10,2) - S(1^{10}) \\
			= P(12,8) + P(4,9) + P(3,10) + P(2,11) + P(1,12) - 1 - 0\\
			= P(12,8) + 5 + 3 + 2\\
			= P(12,3) + P(9,4) + P(8,5) + P(7,6) + P(6,7) + P(5,8) + 10\\
			= 7 + P(9,3) + P(6,3) + P(3,3) + P(8,3) + P(5,3) + P(2,2) + P(4,4) + P(7,3) + P(4,4) + P(3,3) + P(2,2) + P(6,6) + P(5,5) + 17\\
			= 7 + 5 + 4 + 2 + 5 + 3 + 1 + 4 + 4 + 4 + 2 + 1 + P(6,3) + P(3,4) + P(2,5) + P(1,6) + P(5,3) + P(2,4) + P(1,5) + 17\\
			= 42 + 4 + 2 + 1 + 1 + 1 + 1 + 3 + 1 + 1 + 1 + 17\\
			= 75$\\
		\item[(b)] For n = 20, compute Unrank(99).
		\item[A:] \nobreak
			Firstly,\\ 
			\begin{equation}
			\begin{split}
			$P(20) = P(20,20) + 1\\
			= P(20,19) + P(1,20) + 1\\
			= P(20,18) + P(2,19) + 2\\
			= P(20,17) + P(3,18) + 4\\
			= P(20,16) + P(4,17) + 7\\
			= P(20,15) + P(5,16) + 12\\
			= P(20,14) + P(6,15) + P(5,3) + P(2,4) + P(1,5) + 12\\
			= P(20,13) + P(7,14) + P(6,6) + 19\\
			= P(20,12) + P(8,13) + P(7,7) + P(6,3) + P(3,4) + P(2,5) + P(1,6) + 20\\
			= P(20,11) + P(9,12) + P(8,8) + P(7,3) + P(4,4) + P(3,5) + P(2,6) + P(1,7) + 31\\
			= P(20,10) + P(10,11) + P(9,9) + P(8,3) + P(5,3) + P(2,4) + P(4,5) + P(3,6) + P(2,7) + P(1,8) + 46\\
			= P(20,9) + P(11,10) + P(10,10) + P(9,3) + P(6,3) + P(3,3) + P(5,3) + P(2,4) + P(1,5) + P(4,6) + P(3,7) + P(2,8) + P(1,9) + 68\\
			= P(20,10) + P(10,3) + P(7,4) + P(6,5) + P(5,6) + P(4,7) + P(3,8) + P(2,9) + P(1,10) + 91\\
			= P(20,10) + P(10,6) + 102,\\$
			\end{split}
			\end{equation}
            \\
			$Then\\
			P(20) - 99 - 1 =  P(20,10) + P(10,6) + 2\\	
			\\
			for\ rank(\lambda) = 99,\ thus\\
			S(\lambda) = P(20,10) + P(10,6) + 2,\ therefore\\
			\lambda_{1} = 10,\ S(\lambda^{'}) = P(10,6) + 2,\ thus\\
			\lambda_{2} = 6,\ S(\lambda^{''}) = 2 = P(4,2) + S(2), so\\
			\lambda_{3} = 2,\ \lambda_{4} = 2.\ And\ 10 + 6 + 2 + 2 = 20.\\
			\\
			So\ we\ get\ \lambda = \{10, 6, 2, 2\} = 10\ 6\ 2^{2}$\\
    \end{enumerate}
	\item For the product space $Z_{3}\times Z_{5}\times Z_{10}$ and Algorithm 8 of the notes:
	\begin{enumerate}
		\item Find Rank(2,2,3), Rank(1,3,2) and Rank(2,1,8).
        \item[A:] \nobreak
                $Rank(2) = 2\\
                Rank(2,2) = 5\cdot Rank(2) + 2 = 12\\
                Rank(2,2,3) = 10\cdot Rank(2,2) + 3 = 123\\
                \\
                Rank(1) = 1\\
                Rank(1,3) = 5\cdot Rank(1) + 5-3-1 = 6\\
                Rank(1,3,2) = 10\cdot Rank(1,3) + 2 = 62\\
                \\
                Rank(2) = 2\\
                Rank(2,1) = 5\cdot Rank(2) + 1 = 11\\
                Rank(2,1,8) = 10\cdot Rank(2,1) + 10-8-1 = 111$\\
        \item[(b)] Compute Unrank(11) and Unrank(67).
        \item[A:] \nobreak
                $Unrank(11),\\
                11\ mod\ 10 = 1,\ 11/10 = 1,\ v_{3} = 10 - 1 - 1 = 8\\
                1\ mod\ 5 = 1,\ 1/5 = 0,\ v_{2} = 1\\
                0\ mod\ 3 = 0,\ 0/5 = 0,\ v_{1} = 0\\
                So,\ Unrank(11) = (0,1,8)\\
                \\
                Unrank(67),
                67\ mod\ 10 = 7,\ 67/10 = 6,\ v_{3} = 7\\
                6\ mod\ 5 = 1,\ 6/5 = 1,\ v_{2} = 5 - 1 - 1 = 3\\
                1\ mod\ 3 = 1,\ 1/3 = 0,\ v_{1} = 1\\
                So,\ Unrank(67) = (1,3,7)$\\
	\end{enumerate}
    \item Consider the $k$ element multi-sets of $n$ objects $\{0,1,2,3,\ldots,n - 1\}$, denoted by $M^{n}_{k}$. For example the enumeration of $M^{3}_{2}$ in lex order is: $\{0,0\}, \{0,1\}, \{0,2\}, \{1,1\}, \{1,2\}, \{2,2\}$.
    \begin{enumerate}
        \item Give a nice formula for the size of $M^{n}_{k}$, i.e. the number of $k$ element multi-sets of $n$. Explain and justify your answer.
        \item[A:] \nobreak
                Firstly, we notice that for each k, the k element multi-sets can be divided by several parts of multi-sets. e.g $M^{3}_{2}$ can be divided as $\lambda_{3} = \{0,0\}, \{0,1\}, \{0,2\}$, $\lambda_{2} = \{1,1\}, \{1,2\}$, $\lambda_{1} = \{2,2\}$. Then we denote every parts of $M^{n}_{k}$ as $\lambda_{n}$, $\lambda_{n-1}$, ..., $\lambda_{1}$, thus we can list the size of $\lambda_{n}$ for each $k$ as below,\\
                $k=1,\ n\\
                k=2,\ n\ n-1\ n-2\ \ldots\ 2\ 1\\
                k=3,\ n\ n-1\ n-2\ \ldots\ 2\ 1\ n-1\ n-2\ \ldots\ 2\ 1\ n-2\ n-3\ \ldots\ 2\ 1\ \ldots\ \ldots\ 2\ 1\ 1\\
                \ldots\ldots$\\
                When $k=1,\ each\ size\ of\ \lambda_{i} = 1,\ k=2,\ size\ of\ \lambda_{i} = i,\ k=3,\ size\ of\ \lambda_{i} = n + (n-1) + (n-2) + \cdots + 1$, We find a clue that is, for $M^{n}_{k}$, $i=n, n-1, n-2, \ldots, 2, 1$, the size of $\lambda_{i}$ always be size of $M^{i}_{k-1}$, so if we denote size of $M^{n}_{k}$ as $S(M^{n}_{k})$, then we get\\
                $S(M^{n}_{k}) = S(M^{n}_{k-1}) + S(M^{n-1}_{k-1}) + \ldots + S(M^{1}_{k-1}) = S(M^{n}_{k-1}) + S(M^{n-1}_{k}).\\
                Proof:\\
                if\ n=1,\ S(M^{1}_{k}) = S(M^{1}_{k-1}) = 1.\ The\ fomula\ above\ is\ correct.\\
                Assume\ that\ formula\ is\ correct\ when\ n=j>1,\\
                i.e.\ S(M^{j}_{k}) = S(M^{j}_{k-1}) + S(M^{j-1}_{k}),\\
			then\ when\ n=j+1,\ according\ to\ the\ rule\ we\ find\ above,\\
                S(M^{j+1}_{k}) = S(\lambda_{j+1}) + (S(\lambda_{j})+S(\lambda_{j-1})+\cdots+S(\lambda_{1}))\\
                = S(M^{j+1}_{k-1}) + (S(M^{j}_{k-1}) + S(M^{n-1}_{k-1}) + \cdots + S(M^{1}_{k-1}))\\
                = S(M^{j+1}_{k-1}) + S(M^{j}_{k})\\
                = S(M^{j+1}_{k-1}) + S(M^{(j+1)-1}_{k}),\\
                That\ means\ when\ n=j+1,\ the\ formula\ is\ also\ correct.\ \nabla$\\
        \item[(b)] Describe in high-level pseudo code algorithms for successor, ranking and unranking for the elements of $M^{n}_{k}$ in lex order.
	\item[A:] \nobreak
		Rank($M^{n}_{k}$) algorithm is below,\\
		$begin\\
		0 \ \ \ \ let\ R\leftarrow 0\\$
    \end{enumerate}

\end{enumerate}

\end{document}
